---
title: "Exploratory Analysis and Visualizations"
output: 
  html_document:
    toc: true
    toc_float: true
    runtime: shiny
    theme: cosmo
    code_folding: hide
---

```{r, echo = FALSE, message = FALSE}
library(tidyverse)
library(leaflet)
```

## Levels of PM2.5 over time in NYC

```{r}
air_df = read_csv("cleaned_data/air_quality_zips.csv")

plot_data = air_df |> 
  filter(name %in% c("Nitrogen dioxide (NO2)", "Ozone (O3)", "Fine particles (PM 2.5)")) |> 
  filter(str_detect(time_period, "Annual Average")) |> 
  mutate(year = str_extract(time_period, "\\d{4}")) |>  
  group_by(year, name) |> 
  summarise(mean_dv = mean(data_value, na.rm = TRUE)) |> 
  ungroup() |> 
  mutate(year = as.numeric(year))
## Removing annual averages causes data loss, removing seasonal averages does not.

plot_data |> 
  filter(name == "Fine particles (PM 2.5)") |>
  ggplot(aes(x = year, y = mean_dv)) +
  geom_point() +
  labs(title = "PM2.5 Levels Throughout NYC Over Time",
       x = "Date",
       y = "Pollutant Level (mcg/m3)")
```

